(function(t){function e(e){for(var i,r,s=e[0],c=e[1],u=e[2],l=0,h=[];l<s.length;l++)r=s[l],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&h.push(a[r][0]),a[r]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);d&&d(e);while(h.length)h.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],i=!0,r=1;r<n.length;r++){var c=n[r];0!==a[c]&&(i=!1)}i&&(o.splice(e--,1),t=s(s.s=n[0]))}return t}var i={},a={app:0},o=[];function r(t){return s.p+"js/"+({about:"about"}[t]||t)+"."+{about:"465b1c1a"}[t]+".js"}function s(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(t){var e=[],n=a[t];if(0!==n)if(n)e.push(n[2]);else{var i=new Promise((function(e,i){n=a[t]=[e,i]}));e.push(n[2]=i);var o,c=document.createElement("script");c.charset="utf-8",c.timeout=120,s.nc&&c.setAttribute("nonce",s.nc),c.src=r(t);var u=new Error;o=function(e){c.onerror=c.onload=null,clearTimeout(l);var n=a[t];if(0!==n){if(n){var i=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src;u.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",u.name="ChunkLoadError",u.type=i,u.request=o,n[1](u)}a[t]=void 0}};var l=setTimeout((function(){o({type:"timeout",target:c})}),12e4);c.onerror=c.onload=o,document.head.appendChild(c)}return Promise.all(e)},s.m=t,s.c=i,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(n,i,function(e){return t[e]}.bind(null,i));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s.oe=function(t){throw console.error(t),t};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var d=u;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("cd49")},"01af":function(t,e,n){"use strict";n("64ba")},"0be0":function(t,e,n){},"0c29":function(t,e,n){},"0d6d":function(t,e,n){"use strict";n("0c29")},"12d7":function(t,e,n){"use strict";n("143f")},"143f":function(t,e,n){},"2de4":function(t,e,n){"use strict";n("7811")},3835:function(t,e,n){"use strict";n("ccd0")},"3f0a":function(t,e,n){t.exports=n.p+"media/game_over.6783d86e.mp3"},"3f1f":function(t,e,n){t.exports=n.p+"media/game_win.0336fd43.mp3"},4823:function(t,e,n){},"584f":function(t,e,n){t.exports=n.p+"media/select_wrong.1903955b.mp3"},6041:function(t,e,n){},"605d":function(t,e,n){t.exports=n.p+"media/fly.5536d4c6.mp3"},"627c":function(t,e,n){"use strict";n("f263")},"64ba":function(t,e,n){},"708a":function(t,e,n){t.exports=n.p+"media/select_correct.321055eb.mp3"},7811:function(t,e,n){},"7e4a":function(t,e,n){"use strict";n("97db")},"97db":function(t,e,n){},a966:function(t,e,n){t.exports=n.p+"media/btn.6efff02d.mp3"},ac0e:function(t,e,n){"use strict";n("6041")},bc6a:function(t,e,n){"use strict";n("4823")},c80b:function(t,e,n){"use strict";n("0be0")},ccd0:function(t,e,n){},cd49:function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var i=n("2b0e"),a=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},o=[],r=(n("7e4a"),n("2877")),s={},c=Object(r["a"])(s,a,o,!1,null,null,null),u=c.exports,l=n("8c4f"),d=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"home_wrap"},[e("div",{staticClass:"globe_base",attrs:{id:"globeViz"}}),e("global-router",{attrs:{currentRoute:t.currentRoute},on:{handleRouteChange:t.handleRouteChange}})],1)},h=[],f=(n("8e6e"),n("456d"),n("2397"),n("bd86")),p=(n("20d6"),n("ac6a"),n("96cf"),n("3b8d")),v=(n("7514"),n("d225")),m=n("b0b4"),g=n("4e2b"),y=n("308d"),_=n("6bb5"),w=n("9ab4"),b=n("60a3"),C=n("cb99"),k=n("5a89"),O=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"main_wrapper"},[e("div",{staticClass:"title_wrapper"},t._l(t.titleTextList,(function(n,i){return e("div",{key:i,staticClass:"tittle_letter",style:t.getLetterStyle(i)},[t._v("\n      "+t._s(n)+"\n    ")])})),0),e("div",{staticClass:"btn_wrapper"},[e("div",{staticClass:"btn",on:{click:t.goToPlaying}},[t._v("开始刮刮")]),e("div",{staticClass:"btn_rank",on:{click:t.goToRank}},[t._v("排行")])])])},j=[],R=(n("28a5"),new i["a"]);function x(t){var e=P();return function(){var n,i=Object(_["a"])(t);if(e){var a=Object(_["a"])(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return Object(y["a"])(this,n)}}function P(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}var M=function(t){Object(g["a"])(n,t);var e=x(n);function n(){var t;return Object(v["a"])(this,n),t=e.apply(this,arguments),t.title="地球刮刮乐",t.letterColorList=["#3b3b3b","#0a4c89","#5d8e61","#a68c76","#09508f"],t}return Object(m["a"])(n,[{key:"titleTextList",get:function(){return this.title.split("")}},{key:"getLetterStyle",value:function(t){var e=this.letterColorList[t%this.letterColorList.length];return"background: ".concat(e)}},{key:"goToPlaying",value:function(){this.$emit("routeChange","playing"),R.$emit("playAudio","btn")}},{key:"goToRank",value:function(){this.$emit("routeChange","rank"),R.$emit("playAudio","btn")}}]),n}(b["c"]);Object(w["a"])([Object(b["b"])()],M.prototype,"msg",void 0),M=Object(w["a"])([b["a"]],M);var A=M,T=A,q=(n("3835"),Object(r["a"])(T,O,j,!1,null,"7284768d",null)),W=q.exports,D=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"router_wrapper"},["main-menu"===t.currentRoute?e("main-menu",{on:{routeChange:t.handleRouteChange}}):t._e(),"playing"===t.currentRoute?e("playing",{on:{routeChange:t.handleRouteChange}}):t._e(),"rank"===t.currentRoute?e("rank",{on:{routeChange:t.handleRouteChange}}):t._e(),e("music-player")],1)},$=[],S=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"playing_wrapper"},[e("div",{staticClass:"top_wrapper"},[e("div",{staticClass:"top_left"},[e("div",{staticClass:"top_item top_blood"},[t._l(t.game.blood,(function(t,n){return e("div",{key:"blood-".concat(n),staticClass:"blood_item blood_active"})})),t._l(10-t.game.blood,(function(t,n){return e("div",{key:"bleed-".concat(n),staticClass:"blood_item blood_bleed"})})),e("div",{staticClass:"blood_label"},[t._v("❤")])],2),e("div",{staticClass:"top_item top_percent"},[e("div",{staticClass:"progress_bar_outer"},[e("div",{staticClass:"progress_bar_inner",style:{width:"".concat(t.game.finishedPercent,"%")}})]),e("div",{staticClass:"top_percent_number"},[t._v(t._s(t.game.finishedPercent)+"%")])])]),e("div",{staticClass:"top_right"},[e("div",{staticClass:"top_item top_timer"},[t._v("\n        "+t._s(t.formatTime(t.game.usedTime))+"\n      ")])])]),e("div",{staticClass:"mid_wrapper"},[e("question-pad",{attrs:{game:t.game}})],1),t.game.questionPad.displayingWinWindow?e("win-window",{attrs:{game:t.game},on:{routeChange:function(e){return t.emitRouteChange(e)}}}):t._e(),t.game.questionPad.displayingLostWindow?e("lost-window",{attrs:{game:t.game},on:{routeChange:function(e){return t.emitRouteChange(e)},restartGame:function(e){return t.restartGame(e)}}}):t._e(),t.game.questionPad.displayingConfetti?e("confetti"):t._e()],1)},I=[],L=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"question_pad_wrap",class:{question_pad_wrap_hide:!t.game.questionPad.displayingQuestionPad}},[e("div",{staticClass:"question_switch",class:{options_wrap_displaying:t.questionPad.displayingCurrent,question_removing:t.questionPad.removingCurrent,question_adding:t.questionPad.addingCurrent},on:{click:t.handleSwitchSentence}},[t._v("\n    切\n  ")]),e("div",{staticClass:"question",class:{options_wrap_displaying:t.questionPad.displayingCurrent,question_removing:t.questionPad.removingCurrent,question_adding:t.questionPad.addingCurrent},attrs:{id:"question_sentence"}},[t._v(t._s(t.slicedAbstract))]),e("div",{staticClass:"options_wrap",class:{options_wrap_displaying:t.questionPad.displayingCurrent,options_wrap_removing:t.questionPad.removingCurrent,options_wrap_adding:t.questionPad.addingCurrent}},t._l(t.options,(function(n,i){return e("div",{key:i,staticClass:"option_item",class:{option_item_wrong:t.questionPad.displayingAnswerColor&&i===t.clickedIdx&&!(n===t.correctAnswer),option_item_correct:t.questionPad.displayingAnswerColor&&n===t.correctAnswer},on:{click:function(e){return t.handleOptionClick(n)}}},[t._v("\n      "+t._s(n)+"\n    ")])})),0)])},B=[];n("14b9"),n("55dd");function N(t){var e=E();return function(){var n,i=Object(_["a"])(t);if(e){var a=Object(_["a"])(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return Object(y["a"])(this,n)}}function E(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}var G=function(t){Object(g["a"])(n,t);var e=N(n);function n(){var t;return Object(v["a"])(this,n),t=e.apply(this,arguments),t.clickedIdx=-1,t.ramdomAbstractIdx=0,t}return Object(m["a"])(n,[{key:"questionPad",get:function(){return this.game.questionPad}},{key:"options",get:function(){try{return this.game.questionPad.questionList[0].options.sort((function(){return Math.random()-.5}))}catch(t){return[]}}},{key:"correctAnswer",get:function(){try{return this.game.questionPad.questionList[0].name_chn}catch(t){return""}}},{key:"slicedAbstract",get:function(){try{var t=this.game.questionPad.questionList[0].name_chn,e=this.game.questionPad.questionList[0].abs_chn.split("。");console.log("sentences",e),this.ramdomAbstractIdx>=e.length-1&&this.getRandomAbstractIdx();var n=this.ramdomAbstractIdx,i=e[n],a=i.split(t);return 1===a.length?"".concat("__".repeat(t.length),"这座城市，").concat(i,"。"):a.join("__".repeat(t.length))+"。"}catch(o){return""}}},{key:"allowClicking",get:function(){return this.game.questionPad.allowClicking}},{key:"mounted",value:function(){console.log("game",this.game)}},{key:"handleOptionClick",value:function(t){this.allowClicking&&(console.log("option",t),this.clickedIdx=this.options.indexOf(t),this.game.selectAnswer(t))}},{key:"getRandomAbstractIdx",value:function(){this.ramdomAbstractIdx=Math.floor(Math.random()*this.game.questionPad.questionList[0].abs_chn.split("。").length-1)}},{key:"handleSwitchSentence",value:function(){this.addRandomAbstractIdx(),this.reInitScroll(),R.$emit("playAudio","btn")}},{key:"reInitScroll",value:function(){var t=document.getElementById("question_sentence");t&&(t.scrollTop=0)}},{key:"addRandomAbstractIdx",value:function(){this.ramdomAbstractIdx=(this.ramdomAbstractIdx+1)%(this.game.questionPad.questionList[0].abs_chn.split("。").length-1)}}]),n}(b["c"]);Object(w["a"])([Object(b["b"])()],G.prototype,"game",void 0),G=Object(w["a"])([b["a"]],G);var V=G,J=V,U=(n("c80b"),Object(r["a"])(J,L,B,!1,null,"08644f98",null)),z=U.exports,Q=(n("7f7f"),function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"win_window_wrap"},[e("div",{staticClass:"win_window"},[e("div",{staticClass:"win_window_showing_before",class:{win_window_showing:t.game.questionPad.displayingWinWindow}},[e("div",{staticClass:"win_window_title"},[t._v("地球，刮出来了!")]),e("div",{staticClass:"win_window_buttons_wrap"},[e("div",{staticClass:"win_window_button",on:{click:t.handleHomeClicked}},[t._v("主页")]),e("div",{staticClass:"win_window_button",on:{click:t.showAddToRankingWindow}},[t._v("加入排行榜")])])])]),e("div",{staticClass:"win_window_add_to_ranking_window",class:{win_window_add_to_ranking_window_show:t.game.questionPad.displayingAddToRankingWindow}},[e("div",{staticClass:"win_window_add_to_ranking_window_used_time"},[t._v("用时："+t._s(t.formatTime(t.game.usedTime)))]),e("div",{staticClass:"win_window_add_to_ranking_window_input_wrap"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"win_window_add_to_ranking_window_input",attrs:{type:"text",placeholder:"输入你的名字"},domProps:{value:t.name},on:{input:[function(e){e.target.composing||(t.name=e.target.value)},t.handleNameChange]}}),e("div",{staticClass:"win_window_add_to_ranking_window_warning",class:{win_window_add_to_ranking_window_warning_show:t.showNameWarning}},[t._v("\n        "+t._s(t.nameWarning)+"\n      ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.words,expression:"words"}],staticClass:"win_window_add_to_ranking_window_input",attrs:{type:"text",placeholder:"输入你的感想"},domProps:{value:t.words},on:{input:[function(e){e.target.composing||(t.words=e.target.value)},t.handleWordsChange]}}),e("div",{staticClass:"win_window_add_to_ranking_window_warning",class:{win_window_add_to_ranking_window_warning_show:t.showWordsWarning}},[t._v("\n        "+t._s(t.wordsWarning)+"\n      ")])]),e("div",{staticClass:"win_window_add_to_ranking_window_buttons_wrap"},[e("div",{staticClass:"win_window_add_to_ranking_window_button",on:{click:t.hideAddToRankingWindow}},[t._v("取消")]),e("div",{staticClass:"win_window_add_to_ranking_window_button",on:{click:t.addToRanking}},[t._v("加入")])])]),e("div",{staticClass:"win_window_add_to_ranking_window_mask",class:{win_window_add_to_ranking_window_mask_show:t.game.questionPad.displayingAddToRankingWindow},on:{click:t.hideAddToRankingWindow}})])}),H=[],F=(n("6b54"),function(t){var e=Math.floor(t/3600),n=Math.floor(t/60),i=t%60,a=e.toString(),o=n.toString(),r=i.toString();return e<10&&(a="0"+a),n<10&&(o="0"+o),i<10&&(r="0"+r),0===e?"".concat(o,":").concat(r):"".concat(a,":").concat(o,":").concat(r)}),X=function(t){return new Promise((function(e){return setTimeout(e,t)}))};function Y(t){var e=K();return function(){var n,i=Object(_["a"])(t);if(e){var a=Object(_["a"])(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return Object(y["a"])(this,n)}}function K(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}var Z=function(t){Object(g["a"])(n,t);var e=Y(n);function n(){var t;return Object(v["a"])(this,n),t=e.apply(this,arguments),t.formatTime=F,t.name="",t.words="",t.nameWarning="",t.wordsWarning="",t.showNameWarning=!1,t.showWordsWarning=!1,t}return Object(m["a"])(n,[{key:"showAddToRankingWindow",value:function(){this.game.questionPad.changeDisplayAddToRankingWindow(!0),R.$emit("playAudio","btn")}},{key:"hideAddToRankingWindow",value:function(){this.game.questionPad.changeDisplayAddToRankingWindow(!1),R.$emit("playAudio","btn")}},{key:"addToRanking",value:function(){this.game.questionPad.changeDisplayAddToRankingWindow(!1),R.$emit("playAudio","btn")}},{key:"handleHomeClicked",value:function(){this.$emit("routeChange","main-menu"),this.game.destroyGame(),R.$emit("playAudio","btn")}},{key:"emitRouteChange",value:function(t){this.$emit("routeChange",t)}},{key:"handleNameChange",value:function(){this.name.length>20?(this.nameWarning="名字不能超过20个字",this.showNameWarning=!0):0===this.name.length?(this.nameWarning="名字不能为空",this.showNameWarning=!0):this.showNameWarning=!1}},{key:"handleWordsChange",value:function(){this.words.length>50?(this.wordsWarning="感想不能超过50个字",this.showWordsWarning=!0):this.showWordsWarning=!1}}]),n}(b["c"]);Object(w["a"])([Object(b["b"])()],Z.prototype,"game",void 0),Z=Object(w["a"])([b["a"]],Z);var tt=Z,et=tt,nt=(n("2de4"),Object(r["a"])(et,Q,H,!1,null,"0fab6ea4",null)),it=nt.exports,at=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"lost_wrap"},[e("div",{staticClass:"lost_window_showing_before",class:{lost_window_showing:t.game.questionPad.displayingLostWindow}},[e("div",{staticClass:"lost_title"},[t._v("地球，刮不开了...")]),e("div",{staticClass:"lost_buttons_wrap"},[e("div",{staticClass:"lost_button",on:{click:t.handleHomeClicked}},[t._v("主页")]),e("div",{staticClass:"lost_button",on:{click:t.handleRestartClicked}},[t._v("重来")])])])])},ot=[];function rt(t){var e=st();return function(){var n,i=Object(_["a"])(t);if(e){var a=Object(_["a"])(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return Object(y["a"])(this,n)}}function st(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}var ct=function(t){Object(g["a"])(n,t);var e=rt(n);function n(){return Object(v["a"])(this,n),e.apply(this,arguments)}return Object(m["a"])(n,[{key:"handleHomeClicked",value:function(){this.$emit("routeChange","main-menu"),R.$emit("playAudio","btn")}},{key:"handleRestartClicked",value:function(){this.$emit("restartGame"),R.$emit("playAudio","btn")}}]),n}(b["c"]);Object(w["a"])([Object(b["b"])()],ct.prototype,"game",void 0),ct=Object(w["a"])([b["a"]],ct);var ut=ct,lt=ut,dt=(n("01af"),Object(r["a"])(lt,at,ot,!1,null,"69001316",null)),ht=dt.exports,ft=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"confetti_wrap"})},pt=[],vt=function(){function t(e){Object(v["a"])(this,t),this.eccentricity=10,this.radius=1/this.eccentricity,this.radius2=this.radius+this.radius,this.PI=Math.PI,this.PI2=2*this.PI,this.sizeMin=3,this.sizeMax=12-this.sizeMin,this.dThetaMin=.4,this.dThetaMax=.7-this.dThetaMin,this.deviation=0,this.dxThetaMin=-.1,this.dxThetaMax=-this.dxThetaMin-this.dxThetaMin,this.dyMin=.13,this.dyMax=.18,this.frame=0,this.outer=document.createElement("div"),this.inner=document.createElement("div"),this.outer.appendChild(this.inner);var n=this.outer.style,i=this.inner.style;this.outerStyle=n,this.innerStyle=i,n.position="absolute",n.width=this.sizeMin+this.sizeMax*Math.random()+"px",n.height=this.sizeMin+this.sizeMax*Math.random()+"px",i.width="100%",i.height="100%",i.backgroundColor=e(),n.perspective="50px",n.transform="rotate("+360*Math.random()+"deg)",this.axis="rotate3D("+Math.cos(360*Math.random())+","+Math.cos(360*Math.random())+",0,",this.theta=360*Math.random(),this.dTheta=this.dThetaMin+this.dThetaMax*Math.random(),i.transform=this.axis+this.theta+"deg)",this.x=window.innerWidth*Math.random(),this.y=-this.deviation,this.dx=Math.sin(this.dxThetaMin+this.dxThetaMax*Math.random()),this.dy=this.dyMin+this.dyMax*Math.random(),n.left=this.x+"px",n.top=this.y+"px",this.splineX=this.createPoisson(),this.splineY=[];for(var a=1,o=this.splineX.length-1;a<o;++a)this.splineY[a]=this.deviation*Math.random();this.splineY[0]=this.splineY[o]=this.deviation*Math.random()}return Object(m["a"])(t,[{key:"interpolation",value:function(t,e,n){return(1-Math.cos(this.PI*n))/2*(e-t)+t}},{key:"createPoisson",value:function(){var t=[this.radius,1-this.radius],e=1-this.radius2,n=[0,1];while(e){var i,a,o,r,s,c,u,l=e*Math.random();for(i=0,a=t.length,e=0;i<a;i+=2){if(r=t[i],s=t[i+1],o=s-r,l<e+o){n.push(l+=r-e);break}e+=o}for(c=l-this.radius,u=l+this.radius,i=t.length-1;i>0;i-=2)a=i-1,r=t[a],s=t[i],r>=c&&r<u?s>u?t[a]=u:t.splice(a,2):r<c&&s>c&&(s<=u?t[i]=c:t.splice(i,0,c,u));for(i=0,a=t.length,e=0;i<a;i+=2)e+=t[i+1]-t[i]}return n.sort()}},{key:"update",value:function(t,e){this.frame+=e,this.x+=this.dx*e,this.y+=this.dy*e,this.theta+=this.dTheta*e;var n=this.frame%7777/7777,i=0,a=1;while(n>=this.splineX[a])i=a++;var o=this.interpolation(this.splineY[i],this.splineY[a],(n-this.splineX[i])/(this.splineX[a]-this.splineX[i]));return n*=this.PI2,this.outerStyle.left=this.x+o*Math.cos(n)+"px",this.outerStyle.top=this.y+o*Math.sin(n)+"px",this.innerStyle.transform=this.axis+this.theta+"deg)",this.y>t+this.deviation}}]),t}(),mt=function(){function t(){Object(v["a"])(this,t),this.timer=void 0,this.frame=void 0,this.confetti=[],this.pointer=0,this.particles=10,this.spread=120,this.container={},this.colorThemes=[function(){return["#ff5252","#ffa852","#ffff52","#a8ff52","#52ff52","#52ffa8","#52ffff","#52a8ff","#5252ff","#a852ff"][10*Math.random()|0]}],this.container=document.createElement("div"),this.container.style.position="fixed",this.container.style.top="0",this.container.style.left="0",this.container.style.width="100%",this.container.style.height="0",this.container.style.overflow="visible",this.container.style.zIndex="9999"}return Object(m["a"])(t,[{key:"render",value:function(){var t=this;if(!this.frame){document.body.appendChild(this.container);var e=this.colorThemes[0];(function n(){var i=new vt(e);t.confetti.push(i),t.container.appendChild(i.outer),t.timer=setTimeout(n,t.spread*Math.random())})();var n=void 0;requestAnimationFrame((function e(i){var a=n?i-n:0;n=i;for(var o=window.innerHeight,r=t.confetti.length-1;r>=0;--r)t.confetti[r].update(o,a)&&(t.container.removeChild(t.confetti[r].outer),t.confetti.splice(r,1));if(t.timer||t.confetti.length)return t.frame=requestAnimationFrame(e);document.body.removeChild(t.container),t.frame=void 0}))}}},{key:"destroy",value:function(){clearTimeout(this.timer),this.timer=void 0,this.confetti=[],this.frame=void 0}}]),t}();function gt(t){var e=yt();return function(){var n,i=Object(_["a"])(t);if(e){var a=Object(_["a"])(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return Object(y["a"])(this,n)}}function yt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}var _t=function(t){Object(g["a"])(n,t);var e=gt(n);function n(){var t;return Object(v["a"])(this,n),t=e.apply(this,arguments),t.renderer={},t}return Object(m["a"])(n,[{key:"mounted",value:function(){this.renderConfetti()}},{key:"renderConfetti",value:function(){this.renderer=new mt,this.renderer.render()}},{key:"beforeDestroy",value:function(){this.renderer.destroy()}}]),n}(b["c"]);Object(w["a"])([Object(b["b"])()],_t.prototype,"msg",void 0),_t=Object(w["a"])([b["a"]],_t);var wt=_t,bt=wt,Ct=Object(r["a"])(bt,ft,pt,!1,null,"efabae9a",null),kt=Ct.exports,Ot=n("2f62"),jt="./city_1_of_4.geojson",Rt=40;i["a"].use(Ot["a"]);var xt=new Ot["a"].Store({state:{voronoiData:[],cityData:[]},mutations:{setDataset:function(t,e){console.log("setDataset",e),t.voronoiData=e,t.cityData=e.features.map((function(t){return t.properties})).sort((function(t,e){return t.id-e.id+Math.random()*Rt})),t.cityData.forEach((function(t){t.options=t.name_options.split("。").sort((function(){return Math.random()-.5}))})),console.log("state.cityData",t.cityData)}},actions:{loadDataset:function(){var t=Object(p["a"])(regeneratorRuntime.mark((function t(e){var n,i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.commit,t.next=3,fetch(jt);case 3:return i=t.sent,t.next=6,i.json();case 6:a=t.sent,n("setDataset",a);case 8:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()}}),Pt=function(){function t(e){Object(v["a"])(this,t),this.config=e,this.questionList=[],this.addingCurrent=!1,this.removingCurrent=!1,this.displayingCurrent=!1,this.displayingAnswerColor=!1,this.displayingWinWindow=!1,this.displayingLostWindow=!1,this.displayingConfetti=!1,this.displayingAddToRankingWindow=!1,this.displayingQuestionPad=!0,this.allowClicking=!1}return Object(m["a"])(t,[{key:"addOneQuestion",value:function(){var t=Object(p["a"])(regeneratorRuntime.mark((function t(e){var n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.addingCurrent=!0,this.questionList.push(e),R.$emit("scratchUp",e.id),R.$emit("flyTo",e),t.next=6,new Promise((function(t){return setTimeout((function(){n.addingCurrent=!1,n.displayingCurrent=!0,n.allowClicking=!0,t()}),n.config.addingTime)}));case 6:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"removeOneQuestion",value:function(){var t=Object(p["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.removingCurrent=!0,t.next=3,new Promise((function(t){return setTimeout((function(){e.questionList.pop(),e.removingCurrent=!1,e.displayingCurrent=!1,t()}),e.config.removingTime)}));case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"removeAndAddQuestion",value:function(){var t=Object(p["a"])(regeneratorRuntime.mark((function t(e){var n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.removeOneQuestion();case 2:return t.next=4,new Promise((function(t){return setTimeout(Object(p["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,n.addOneQuestion(e);case 2:t();case 3:case"end":return i.stop()}}),i)}))),n.config.gapTime)}));case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"displayAnswer",value:function(){var t=Object(p["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.displayingAnswerColor=!0,t.next=3,new Promise((function(t){return setTimeout((function(){e.displayingAnswerColor=!1,t()}),e.config.answerDisplayTime)}));case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"changeLostWindowDisplay",value:function(t){this.displayingLostWindow=t}},{key:"changeWinWindowDisplay",value:function(t){this.displayingWinWindow=t}},{key:"changeDisplayAddToRankingWindow",value:function(t){this.displayingAddToRankingWindow=t}}]),t}(),Mt=Pt,At=function(){function t(e){Object(v["a"])(this,t),this.usedTime=0;var n=e.cityData,i=e.blood;this.cityData=n,this.blood=i,this.finishedPercent=0,this.finishedCount=0,this.initialDataSize=n.length,this.currentCity=null,this.lostCities=[],this.timerId=0,this.questionPad=new Mt({removingTime:300,addingTime:300,gapTime:100,answerDisplayTime:600})}return Object(m["a"])(t,[{key:"play",value:function(){var t=this;R.$emit("globeRotate",!1),console.log("game start"),R.$emit("renderScratches",(function(){console.log("loading first question"),t.currentCity=t.getNextCurrentCityCandidate(),t.questionPad.addOneQuestion(t.currentCity),t.startTimer(),R.$emit("playAudio","fly")}))}},{key:"startTimer",value:function(){var t=this;this.timerId=setInterval((function(){t.usedTime+=1}),1e3)}},{key:"selectAnswer",value:function(t){this.questionPad.allowClicking=!1,this.judgeAnswer(t)}},{key:"judgeAnswer",value:function(t){t===this.currentCity.name_chn?this.ifAnswerCorrect():this.ifAnswerWrong()}},{key:"ifAnswerCorrect",value:function(){this.questionPad.displayAnswer(),R.$emit("scratchOff",this.currentCity.id),this.finishedCount+=1,this.finishedPercent=this.getFinishedPercent(),this.checkIfWin()?(this.gameWin(),R.$emit("playAudio","game_win")):(this.updateCurrentCity(),R.$emit("playAudio","select_correct"),setTimeout((function(){return R.$emit("playAudio","fly")}),500))}},{key:"ifAnswerWrong",value:function(){this.questionPad.displayAnswer(),this.blood-=1,R.$emit("scratchDown",this.currentCity.id),this.lostCities.push(this.currentCity),this.checkIfLost()?(this.gameOver(),R.$emit("playAudio","game_over")):(this.cityData.push(this.currentCity),this.updateCurrentCity(),R.$emit("playAudio","select_wrong"),setTimeout((function(){return R.$emit("playAudio","fly")}),500))}},{key:"updateCurrentCity",value:function(){var t=Object(p["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.getNextCurrentCityCandidate(),t.next=3,this.questionPad.displayAnswer();case 3:this.questionPad.removeAndAddQuestion(e),this.currentCity=e;case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getFinishedPercent",value:function(){return Math.round(this.finishedCount/this.initialDataSize*100)}},{key:"getNextCurrentCityCandidate",value:function(){var t=this.cityData.shift();return console.log("getNextCurrentCityCandidate",t),console.log("this.cityData.shift()",this.cityData),t}},{key:"checkIfWin",value:function(){return 0===this.cityData.length}},{key:"checkIfLost",value:function(){return 0===this.blood}},{key:"gameOver",value:function(){console.log("game over"),this.questionPad.changeLostWindowDisplay(!0),clearInterval(this.timerId),this.questionPad.displayingQuestionPad=!1,R.$emit("globeRotate",!0)}},{key:"gameWin",value:function(){this.questionPad.changeWinWindowDisplay(!0),clearInterval(this.timerId),this.questionPad.displayingConfetti=!0,this.questionPad.displayingQuestionPad=!1,R.$emit("globeRotate",!0)}},{key:"destroyGame",value:function(){this.questionPad.displayingConfetti=!1}}]),t}(),Tt=At;function qt(t){var e=Wt();return function(){var n,i=Object(_["a"])(t);if(e){var a=Object(_["a"])(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return Object(y["a"])(this,n)}}function Wt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}var Dt=function(t){Object(g["a"])(n,t);var e=qt(n);function n(){var t;return Object(v["a"])(this,n),t=e.apply(this,arguments),t.game=new Tt({cityData:xt.state.cityData,blood:3}),t.formatTime=F,t}return Object(m["a"])(n,[{key:"mounted",value:function(){console.log("mounted"),this.game=new Tt({cityData:xt.state.cityData,blood:10}),this.game.play(),console.log("game",this.game)}},{key:"emitRouteChange",value:function(t){this.$emit("routeChange",t)}},{key:"restartGame",value:function(){var t=Object(p["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.game.destroyGame(),this.game=new Tt({cityData:xt.state.cityData,blood:10}),this.game.play();case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"beforeDestroy",value:function(){this.game.destroyGame()}}]),n}(b["c"]);Object(w["a"])([Object(b["b"])()],Dt.prototype,"msg",void 0),Dt=Object(w["a"])([Object(b["a"])({components:{QuestionPad:z,WinWindow:it,LostWindow:ht,Confetti:kt}})],Dt);var $t=Dt,St=$t,It=(n("bc6a"),Object(r["a"])(St,S,I,!1,null,"57ff486c",null)),Lt=It.exports,Bt=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"rank_wrap"},[e("div",{staticClass:"rank_body"},[e("div",{staticClass:"rank_body_title"},[t._v("排行榜")]),e("div",{staticClass:"rank_body_list"},[t._m(0),e("div",{staticClass:"rank_body_list_wrap"},t._l(t.rankList,(function(n,i){return e("div",{key:i,staticClass:"rank_body_list_item"},[e("div",{staticClass:"rank_body_list_item_block rank_body_list_item_rank"},[t._v(t._s(i+1))]),e("div",{staticClass:"rank_body_list_item_block rank_body_list_item_used_time"},[t._v(t._s(t.formatTime(n.usedTime)))]),e("div",{staticClass:"rank_body_list_item_block rank_body_list_item_name"},[e("pop-over",{attrs:{text:n.name}})],1),e("div",{staticClass:"rank_body_list_item_block rank_body_list_item_words"},[e("pop-over",{attrs:{text:n.words}})],1)])})),0)])]),e("div",{staticClass:"rank_go_back",on:{click:function(e){return t.emitRouteChange("main-menu")}}},[t._v("返回")])])},Nt=[function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"rank_body_top_row"},[e("div",{staticClass:"rank_body_top_row_rank"},[t._v("🏆")]),e("div",{staticClass:"rank_body_top_row_time"},[t._v("用时")]),e("div",{staticClass:"rank_body_top_row_name"},[t._v("名字")]),e("div",{staticClass:"rank_body_top_row_words"},[t._v("感想")])])}],Et=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"pop_over_wrap"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.showingPopOver,expression:"showingPopOver"}],staticClass:"pop_over_body",class:{pop_over_body_smaller:t.text.length<10}},[t._v(t._s(t.text))]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showingPopOver,expression:"showingPopOver"}],staticClass:"pop_over_arrow"}),e("div",{staticClass:"pop_over_content",on:{mouseover:t.handleHover,mouseout:t.handleLeave}},[t._v(t._s(t.text))])])},Gt=[];function Vt(t){var e=Jt();return function(){var n,i=Object(_["a"])(t);if(e){var a=Object(_["a"])(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return Object(y["a"])(this,n)}}function Jt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}var Ut=function(t){Object(g["a"])(n,t);var e=Vt(n);function n(){var t;return Object(v["a"])(this,n),t=e.apply(this,arguments),t.showingPopOver=!1,t}return Object(m["a"])(n,[{key:"showPopOver",value:function(){this.showingPopOver=!0}},{key:"hidePopOver",value:function(){this.showingPopOver=!1}},{key:"handleHover",value:function(){this.showPopOver()}},{key:"handleLeave",value:function(){this.hidePopOver()}}]),n}(b["c"]);Object(w["a"])([Object(b["b"])()],Ut.prototype,"text",void 0),Ut=Object(w["a"])([b["a"]],Ut);var zt=Ut,Qt=zt,Ht=(n("627c"),Object(r["a"])(Qt,Et,Gt,!1,null,"49cec9b2",null)),Ft=Ht.exports;function Xt(t){var e=Yt();return function(){var n,i=Object(_["a"])(t);if(e){var a=Object(_["a"])(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return Object(y["a"])(this,n)}}function Yt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}var Kt=function(t){Object(g["a"])(n,t);var e=Xt(n);function n(){var t;return Object(v["a"])(this,n),t=e.apply(this,arguments),t.formatTime=F,t.rankList=[{name:"明",usedTime:100,words:"我是小明"},{name:"小红红红红红红红红红红红红红红红红红",usedTime:100,words:"一二三四五六七八九十一二三四五六七八九十一二三四五六七八九十一二三四五六七八九十一二三四五六七八九十"},{name:"小刚",usedTime:100,words:"我是小红，啊啊束带结发速度快放假山卡拉电极法卡萨电极法凯撒登记了看法久啊山卡拉登记上束带结发速度快放假山卡拉电极法卡萨电极"}],t}return Object(m["a"])(n,[{key:"emitRouteChange",value:function(t){this.$emit("routeChange",t),R.$emit("playAudio","btn")}}]),n}(b["c"]);Object(w["a"])([Object(b["b"])()],Kt.prototype,"msg",void 0),Kt=Object(w["a"])([Object(b["a"])({components:{PopOver:Ft}})],Kt);var Zt=Kt,te=Zt,ee=(n("ac0e"),Object(r["a"])(te,Bt,Nt,!1,null,"267428c9",null)),ne=ee.exports,ie=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"audio_wrapper"},[e("audio",{ref:"audio_game_over",staticClass:"audio_game_over",attrs:{hidden:"",src:n("3f0a")}}),e("audio",{ref:"audio_game_win",staticClass:"audio_game_win",attrs:{hidden:"",src:n("3f1f")}}),e("audio",{ref:"audio_select_correct",staticClass:"audio_select_correct",attrs:{hidden:"",src:n("708a")}}),e("audio",{ref:"audio_select_wrong",staticClass:"audio_select_wrong",attrs:{hidden:"",src:n("584f")}}),e("audio",{ref:"audio_btn",staticClass:"audio_btn",attrs:{hidden:"",src:n("a966")}}),e("audio",{ref:"audio_fly",staticClass:"audio_fly",attrs:{hidden:"",src:n("605d")}})])},ae=[];function oe(t){var e=re();return function(){var n,i=Object(_["a"])(t);if(e){var a=Object(_["a"])(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return Object(y["a"])(this,n)}}function re(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}var se=function(t){Object(g["a"])(n,t);var e=oe(n);function n(){var t;return Object(v["a"])(this,n),t=e.apply(this,arguments),t.isBackgroundMusicPlaying=!1,t}return Object(m["a"])(n,[{key:"mounted",value:function(){this.adjustVolume(),this.watchAllAudios()}},{key:"adjustVolume",value:function(){var t=this.$refs.audio_game_over,e=this.$refs.audio_game_win,n=this.$refs.audio_select_correct,i=this.$refs.audio_select_wrong,a=this.$refs.audio_btn,o=this.$refs.audio_fly;t.volume=.5,e.volume=.5,n.volume=.3,i.volume=1,a.volume=.3,o.volume=.7}},{key:"watchAllAudios",value:function(){var t=this;R.$on("playAudio",(function(e){var n=t.$refs["audio_".concat(e)];console.log("get refs here",t.$refs),console.log("get audioName here",e),console.log("get audio here",n),n.currentTime=0,n.play()}))}}]),n}(b["c"]);se=Object(w["a"])([b["a"]],se);var ce=se,ue=ce,le=Object(r["a"])(ue,ie,ae,!1,null,"33ab49ca",null),de=le.exports;function he(t){var e=fe();return function(){var n,i=Object(_["a"])(t);if(e){var a=Object(_["a"])(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return Object(y["a"])(this,n)}}function fe(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}var pe=function(t){Object(g["a"])(n,t);var e=he(n);function n(){return Object(v["a"])(this,n),e.apply(this,arguments)}return Object(m["a"])(n,[{key:"handleRouteChange",value:function(t){this.$emit("handleRouteChange",t),"playing"===t?R.$emit("globeRotate",!1):R.$emit("globeRotate",!0)}}]),n}(b["c"]);Object(w["a"])([Object(b["b"])()],pe.prototype,"currentRoute",void 0),pe=Object(w["a"])([Object(b["a"])({components:{MainMenu:W,Playing:Lt,Rank:ne,MusicPlayer:de}})],pe);var ve=pe,me=ve,ge=(n("12d7"),Object(r["a"])(me,D,$,!1,null,"bca442c0",null)),ye=ge.exports,_e=new k["J"]({shininess:5,color:"#666666",specular:"#888888",reflectivity:.5,flatShading:!0,transparent:!0,opacity:1});function we(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function be(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?we(Object(n),!0).forEach((function(e){Object(f["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ce(t){var e=ke();return function(){var n,i=Object(_["a"])(t);if(e){var a=Object(_["a"])(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return Object(y["a"])(this,n)}}function ke(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}var Oe=function(t){Object(g["a"])(n,t);var e=Ce(n);function n(){var t;return Object(v["a"])(this,n),t=e.apply(this,arguments),t.currentRoute="main-menu",t.globe={threeJsModel:null},t.data={voronoi:null,currentCityIdx:0},t.sleeper=X,t}return Object(m["a"])(n,[{key:"mounted",value:function(){var t=this.renderInit();t.renderGlobe(),this.actionManager().initWatchers()}},{key:"renderInit",value:function(){var t=this,e={renderGlobe:function(){var n=Object(C["a"])({rendererConfig:{powerPreference:"high-performance"}}).globeImageUrl("./globe_terrain.jpeg").bumpImageUrl("//unpkg.com/three-globe/example/img/earth-topology.png").backgroundImageUrl("./grey-sky.png").atmosphereColor("#d7f0f6").atmosphereAltitude(.25).lineHoverPrecision(0).onGlobeReady((function(){console.log("world.scene()",n.scene()),e.renderClouds(n),e.renderLight(n.scene()),t.globe.threeJsModel=n}))(document.getElementById("globeViz")),i=n.globeMaterial();i.bumpScale=10,(new k["ab"]).load("//unpkg.com/three-globe/example/img/earth-water.png",(function(t){i.specularMap=t,i.specular=new k["h"]("grey"),i.shininess=15})),n.controls().autoRotate=!0,n.controls().autoRotateSpeed=.35,t.dataManager().getVoronois()},renderScratches:function(e){var n=t.data.voronoi;n&&(e.polygonsData(n.features).polygonAltitude((function(t){return t.properties.polygonAltitude})).polygonCapCurvatureResolution(10).polygonCapMaterial(_e).polygonSideColor((function(){return"#444444"})).polygonsTransitionDuration(1e3),console.log("loaded completely"))},clearScratches:function(t){console.log("clearScratches"),t.polygonAltitude(-.1)},renderClouds:function(t){var e="./clouds.png",n=.009,i=-.006;(new k["ab"]).load(e,(function(e){var a=new k["G"](new k["X"](t.getGlobeRadius()*(1+n),75,75),new k["J"]({map:e,transparent:!0}));t.scene().add(a),function t(){a.rotation.y+=i*Math.PI/180,requestAnimationFrame(t)}()}))},renderLight:function(t){var e=t.children.find((function(t){return"AmbientLight"===t.type}));e.intensity=.8;var n=t.children.find((function(t){return"DirectionalLight"===t.type}));n.intensity=0;var i=500,a=new k["O"](16777215,1,1e3),o=new k["O"](16777215,1,1e3),r=new k["O"](16777215,1,1e3);a.position.set(i,0,0),o.position.set(-.5*i,.866*i,0),r.position.set(-.5*i,-.866*i,5),t.add(a,o,r)}};return e}},{key:"dataManager",value:function(){var t=this;return{getVoronois:function(){var e=Object(p["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,xt.dispatch("loadDataset");case 2:console.log("ressss",xt.state.cityData),t.data.voronoi=xt.state.voronoiData,t.data.voronoi&&t.data.voronoi.features.forEach((function(t){return t.properties.polygonAltitude=.06}));case 5:case"end":return e.stop()}}),e)})));function n(){return e.apply(this,arguments)}return n}(),updataVoronoi:function(e){console.log("updating voronoi",e),t.data.voronoi=e,t.data.voronoi&&t.data.voronoi.features.forEach((function(t){return t.properties.polygonAltitude=.06}));var n=t.globe.threeJsModel;n.polygonsData(e.features)},reInitVoronoiData:function(){var e=JSON.parse(JSON.stringify(t.data.voronoi));e&&e.features.forEach((function(t){return t.properties.polygonAltitude=.06})),t.data.voronoi=e},changeRevealedScratchAltitude:function(e,n){t.data.voronoi.features[e].properties.polygonAltitude=n}}}},{key:"actionManager",value:function(){var t=this,e=this;return{scratchUpdate:function(t,n){var i=e.data.voronoi.features.findIndex((function(e){return e.properties.id===t}));e.dataManager().changeRevealedScratchAltitude(i,n);var a=e.globe.threeJsModel,o=e.data.voronoi;a.polygonsData(o.features)},initWatchers:function(){t.actionManager().watchScratchUp(),t.actionManager().watchScratchDown(),t.actionManager().watchScratchOff(),t.actionManager().watchFlyTo(),t.actionManager().watchGlobeRotate(),t.actionManager().watchUpdateVoronoi(),t.actionManager().watchRenderScratches()},watchScratchUp:function(){R.$on("scratchUp",(function(t){return e.actionManager().scratchUpdate(t,.02)}))},watchScratchDown:function(){R.$on("scratchDown",(function(t){return e.actionManager().scratchUpdate(t,.04)}))},watchScratchOff:function(){R.$on("scratchOff",(function(t){return e.actionManager().scratchUpdate(t,-.1)}))},watchUpdateVoronoi:function(){R.$on("updateVoronoi",(function(t){return e.dataManager().updataVoronoi(t)}))},watchRenderScratches:function(){R.$on("renderScratches",function(){var t=Object(p["a"])(regeneratorRuntime.mark((function t(n){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=e.globe.threeJsModel,e.renderInit().clearScratches(i),t.next=4,X(1e3);case 4:return e.dataManager().reInitVoronoiData(),t.next=7,e.renderInit().renderScratches(i);case 7:n();case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},watchFlyTo:function(){R.$on("flyTo",(function(t){return e.animationManager().flyToPosition({delay:100,lat:t.lat,lng:t.lon,time:800})}))},watchGlobeRotate:function(){R.$on("globeRotate",(function(t){var n=e.globe.threeJsModel;n.controls().autoRotate=t}))}}}},{key:"animationManager",value:function(){var t=this;return{flyToPosition:function(e){var n=t.globe.threeJsModel;setTimeout((function(){n&&n.pointOfView(be({},e),e.time)}),e.delay)}}}},{key:"handleRouteChange",value:function(t){this.currentRoute=t,"main-menu"===t?R.$emit("enableEarthRotation"):"playing"===t&&(R.$emit("disableEarthRotation"),R.$emit("playAgain"))}}]),n}(b["c"]);Oe=Object(w["a"])([Object(b["a"])({components:{MainMenu:W,GlobalRouter:ye}})],Oe);var je=Oe,Re=je,xe=(n("0d6d"),Object(r["a"])(Re,d,h,!1,null,"599b94a5",null)),Pe=xe.exports;i["a"].use(l["a"]);var Me=new l["a"]({mode:"hash",base:"",routes:[{path:"/",name:"home",component:Pe},{path:"/about",name:"about",component:function(){return n.e("about").then(n.bind(null,"f820"))}}]});i["a"].config.productionTip=!1,new i["a"]({router:Me,store:xt,render:function(t){return t(u)}}).$mount("#app")},f263:function(t,e,n){}});
//# sourceMappingURL=app.df00f5d3.js.map